# Spotify Bot Provider Configuration
# ===================================
# Clean Architecture Research Project - RWTH MATSE

spring:
  application:
    name: goodfellaz17-provider

  # WebFlux Static Resources
  webflux:
    static-path-pattern: "/**"
  web:
    resources:
      static-locations: classpath:/static/
      add-mappings: true

  # Database - Uses NEON_* vars (REQUIRED in production)
  r2dbc:
    url: r2dbc:postgresql://${NEON_HOST}:5432/${NEON_DB}?sslmode=require
    username: ${NEON_USER}
    password: ${NEON_PASSWORD}
    pool:
      initial-size: 5
      max-size: 20

  # Async task execution
  task:
    execution:
      pool:
        core-size: 50
        max-size: 100
        queue-capacity: 1000
      thread-name-prefix: async-

# Server Configuration
server:
  port: ${PORT:8080}
  error:
    whitelabel:
      enabled: false
    include-message: always
    include-binding-errors: always

# Bot Executor Configuration
bot:
  executor:
    max-concurrent: ${BOT_MAX_CONCURRENT:100}
  
  # Compliance thresholds (Spotify detection avoidance)
  compliance:
    max-hourly-spike: 0.05      # 5% max hourly spike
    min-duration-seconds: 35     # Royalty eligibility threshold
    min-session-variance: 5      # Random +/- seconds per session
  
  # Account Farm Configuration
  accounts:
    farm-size: ${ACCOUNT_FARM_SIZE:100}
    max-daily-plays-per-account: 500
    cooldown-hours: 24

# Proxy Provider Configuration
proxy:
  # Health check settings
  health:
    enabled: true
    interval-seconds: 60
  
  # TOR Network (FREE - Multi-port rotation)
  tor:
    enabled: ${TOR_ENABLED:true}
    host: ${TOR_HOST:127.0.0.1}
    ports: ${TOR_PORTS:9050,9051,9052,9060}
    capacity-per-day: 500000
    cost-per-1k: 0.00  # FREE!
  
  # BrightData Residential Proxies
  brightdata:
    enabled: ${BRIGHTDATA_ENABLED:false}
    host: brd.superproxy.io
    port: 22225
    username: ${BRIGHTDATA_USER:}
    password: ${BRIGHTDATA_PASSWORD:}
    zone: ${BRIGHTDATA_ZONE:residential}
  
  # SOAX Residential Proxies
  soax:
    enabled: ${SOAX_ENABLED:false}
    host: proxy.soax.com
    port: 9000
    username: ${SOAX_USER:}
    password: ${SOAX_PASSWORD:}

# User Arbitrage Configuration
arbitrage:
  commission-rate: 0.30        # 30% to users
  task-timeout-seconds: 300    # 5 min task deadline

# Spotify OAuth Configuration
spotify:
  client-id: ${SPOTIFY_CLIENT_ID:}
  client-secret: ${SPOTIFY_CLIENT_SECRET:}
  redirect-uri: ${SPOTIFY_REDIRECT_URI:https://goodfellaz17.onrender.com/callback}

# Stripe Payment Configuration
stripe:
  secret-key: ${STRIPE_SECRET_KEY:sk_test_placeholder}
  webhook-secret: ${STRIPE_WEBHOOK_SECRET:whsec_placeholder}
  publishable-key: ${STRIPE_PUBLISHABLE_KEY:pk_test_placeholder}

# Coinbase Commerce (Crypto Payments)
coinbase:
  api-key: ${COINBASE_API_KEY:}
  webhook-secret: ${COINBASE_WEBHOOK_SECRET:}

# Resend Email Configuration
resend:
  api-key: ${RESEND_API_KEY:}
  from-email: ${RESEND_FROM_EMAIL:orders@goodfellaz17.com}
  enabled: ${RESEND_ENABLED:true}

# App Configuration
app:
  base-url: ${APP_BASE_URL:https://goodfellaz17.onrender.com}

# SpringDoc OpenAPI / Swagger
springdoc:
  swagger-ui:
    path: /docs
    enabled: true
    operationsSorter: method
    tagsSorter: alpha
  api-docs:
    path: /api-docs
    enabled: true

# Actuator (Monitoring)
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always

# Logging
logging:
  level:
    root: INFO
    com.goodfellaz17: DEBUG
    org.springframework.web: INFO
    org.openqa.selenium: WARN
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

---
# Development Profile
spring:
  config:
    activate:
      on-profile: dev

proxy:
  brightdata:
    enabled: false
  soax:
    enabled: false

bot:
  executor:
    max-concurrent: 10

logging:
  level:
    com.goodfellaz17: TRACE

---
# Production Profile
spring:
  config:
    activate:
      on-profile: prod

proxy:
  brightdata:
    enabled: ${BRIGHTDATA_ENABLED:true}
  soax:
    enabled: ${SOAX_ENABLED:true}

bot:
  executor:
    max-concurrent: 1000

logging:
  level:
    com.goodfellaz17: INFO
